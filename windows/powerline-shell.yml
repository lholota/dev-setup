## Fonts
- name: "Download Powerline fonts"
  win_get_url:
    url: https://github.com/powerline/fonts/archive/master.zip
    dest: "%TEMP%\\PowerlineFonts.zip"
    
- name: "Extract Powerline fonts"
  win_unzip:
    src: "%TEMP%\\PowerlineFonts.zip"
    dest: "%TEMP%"

- name: "Find font files"
  register: powerline_fonts
  win_find:
    paths: 
      - "{{ ansible_env.TEMP }}\\fonts-master"
    patterns: [ '*.otf', '*.ttf' ]
    recurse: yes

# - name: "Copy fonts"
#   win_copy:
#     src: "{{ item.path }}"
#     remote_src: yes
#     dest: "%SYSTEMROOT%\\fonts\\{{ item.path | win_basename }}"
#   loop: "{{ powerline_fonts.files }}"

# - name: "Create registry entries"
#   win_regedit:
#     path: "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts"
#     name: "{{ item.path | win_basename }}"
#     data: "{{ item.path | win_basename }}"
#   loop: "{{ powerline_fonts.files }}"

## Windows Terminal Options
- name: "Find Windows Terminal AppData Directory"
  register: terminal_appdata
  win_find:
    paths: "{{ ansible_env.LOCALAPPDATA }}\\Packages"
    patterns: "Microsoft.WindowsTerminal_*"
    file_type: "directory"

- name: "Debug"
  debug:
    var: terminal_appdata

# - name: Load settings
#   slurp:
#     src: /tmp/var.json
#   register: imported_var

# - debug:
#     msg: "{{ imported_var.content|b64decode|from_json }}"

# - name: append more key/values
#   set_fact:
#     imported_var: "{{ imported_var.content|b64decode|from_json | default([]) | combine({ 'hello': 'world' }) }}"

# - debug:
#     var: imported_var

# - name: write var to file
#   copy: 
#     content: "{{ imported_var | to_nice_json }}" 
#     dest: /tmp/final.json